Experiment:
    name: main_loop
    class_name: cognitive_processes.main_loop.MainLoopLight
    new_executor: True
    threads: 2
    parameters: 
        iterations: 2000
        trials: 5
        softmax_selection: False
        softmax_temperature: 0.3
        kill_on_finish: True
Control:
    id: ltm_simulator
    control_topic: /main_loop/control
    control_msg: cognitive_processes_interfaces.msg.ControlMsg
    episodes_topic: /main_loop/episodes
    episodes_msg: cognitive_node_interfaces.msg.Episode
    executed_action_service: /mdb/baxter/executed_action
    executed_action_msg: cognitive_node_interfaces.srv.Action
    world_reset_service: /mdb/baxter/world_reset
    world_reset_msg: cognitive_processes_interfaces.srv.WorldReset
LTM:
    Globals:
        actuation_config:
            left_arm: ["dist", "angle"]
            right_arm: ["dist", "angle"]

    Files:
        -
            id: goodness
            class: core.file.FileGoodness
            file: goodness.txt
        # -
        #     id: pnodes_success
        #     class: core.file.FilePNodesSuccess
        #     file: pnodes_success.txt
        -
            id: pnodes_content
            class: core.file.FilePNodesContent
            file: pnodes_content.txt
            parameters:
                save_interval: 0
        -
            id: trials
            class: core.file.FileTrialsSuccess
            file: trials.txt
        -
            id: dataset
            class: core.file.FileEpisodesDataset
            file: dataset.csv
        -
            id: world_model_success
            class: core.file.FileWorldModelSuccess
            file: world_model_success.txt
        -
            id: save_models
            class: core.file.FileSaveModels
            file: models_save
            parameters:
                save_interval: 0

    Connectors:
        -
            data: Space
            default_class: cognitive_nodes.space.ANNSpace
        -
            data: Perception
            default_class: cognitive_nodes.perception.Perception
        -
            data: PNode
            default_class: cognitive_nodes.pnode.PNode
            parameters:
                space_class: cognitive_nodes.space.ANNSpace
                history_size: 500      
        -
            data: CNode
            default_class: cognitive_nodes.cnode.CNode
        -
            data: Goal
            default_class: cognitive_nodes.goal.GoalMotiven
            parameters:
                space_class: cognitive_nodes.space.ANNSpace
                history_size: 300  
                min_confidence: 0.94  
                ltm_id: ltm_0
        -
            data: WorldModel
            default_class: cognitive_nodes.world_model.WorldModelLearned
            parameters:
                episodes_topic: /main_loop/episodes
                prediction_srv_type: cognitive_node_interfaces.srv.Predict
                main_size: 2000
                train_sample: 200
                train_split: 0.8
                validation_split: 0.1
                secondary_size: 50
                retrain: True
        -
            data: UtilityModel
            default_class: cognitive_nodes.utility_model.QUtilityModel
            parameters:
                    max_iterations: 50
                    candidate_actions: 100
                    ltm_id: ltm_0
                    candidate_generation: "latin"
                    softmax_selection: True
                    softmax_temperature: 0.01
                    trace_length: 20
                    min_traces: 20
                    max_traces: 200
                    train_traces: 10
                    train_every: 5
                    replace_every: 5
                    discount_factor: 0.9
                    reward_factor: 10.0
                    max_antitraces: 5
                    evaluation_method: "exponential"
                    epochs: 100
                    batch_size: 16
                    learning_rate: 0.0005
                    output_activation: "linear"
                    hidden_layers: [256, 128]
        -
            data: Policy
            default_class: cognitive_nodes.policy.PolicyBlocking

    Nodes:
        Perception:
            -
                name: ball_angle
                class_name: sim_2d_emdb.perception.Sim2DDistancesPerception
                parameters:
                    default_msg: std_msgs.msg.Float32
                    default_topic: /mdb/baxter/sensor/ball_angle
                    normalize_data:
                        min_value: -1300
                        max_value: 1300
            -
                name: box_angle
                class_name: sim_2d_emdb.perception.Sim2DDistancesPerception
                parameters:
                    default_msg: std_msgs.msg.Float32
                    default_topic: /mdb/baxter/sensor/box_angle
                    normalize_data:
                        min_value: -1300
                        max_value: 1300
            -
                name: dist_ball_box
                class_name: sim_2d_emdb.perception.Sim2DDistancesPerception
                parameters:
                    default_msg: simulators_interfaces.msg.ObjectListMsg
                    default_topic: /mdb/baxter/sensor/dist_ball_box
                    normalize_data:
                        distance_min: 0
                        distance_max: 3000
                        angle_min: -180
                        angle_max: 180
            -
                name: dist_left_arm_ball
                class_name: sim_2d_emdb.perception.Sim2DDistancesPerception
                parameters:
                    default_msg: simulators_interfaces.msg.ObjectListMsg
                    default_topic: /mdb/baxter/sensor/dist_left_arm_ball
                    normalize_data:
                        distance_min: 0
                        distance_max: 3000
                        angle_min: -180
                        angle_max: 180
            -
                name: dist_right_arm_ball
                class_name: sim_2d_emdb.perception.Sim2DDistancesPerception
                parameters:
                    default_msg: simulators_interfaces.msg.ObjectListMsg
                    default_topic: /mdb/baxter/sensor/dist_right_arm_ball
                    normalize_data:
                        distance_min: 0
                        distance_max: 3000
                        angle_min: -180
                        angle_max: 180

            
        RobotPurpose: 
            -
                name: object_in_box_need
                class_name: cognitive_nodes.robot_purpose.RobotPurpose
                parameters:
                    weight: 1.0
                    drive_id: 'object_in_box_drive'
                    purpose_type: 'Mission'
                    terminal: True
            -
                name: grasped_ball_need
                class_name: cognitive_nodes.robot_purpose.RobotPurpose
                parameters:
                    weight: 0.8
                    drive_id: 'grasped_ball_drive'
                    purpose_type: 'Mission'
                    terminal: False
            - 
                name: novelty_need
                class_name: cognitive_nodes.robot_purpose.RobotPurpose
                parameters:
                    weight: 0.1
                    drive_id: 'novelty_drive'
                    purpose_type: 'Need'
            - 
                name: effectance_need
                class_name: cognitive_nodes.robot_purpose.RobotPurpose
                parameters:
                    weight: 0.25
                    drive_id: 'effectance_drive'
                    purpose_type: 'Need'
            - 
                name: model_creation_need
                class_name: cognitive_nodes.robot_purpose.RobotPurpose
                parameters:
                    weight: 1.0
                    drive_id: 'model_creation_drive'
                    purpose_type: 'Need'

        Drive:
            -
                name: object_in_box_drive
                class_name: cognitive_nodes.drive.DriveExponential
                parameters:
                    input_topic: /mdb/baxter/sensor/ball_in_box
                    input_msg: std_msgs.msg.Float32
                    min_eval: 0.8 
                    neighbors: [{"name": "object_in_box_need", "node_type": "RobotPurpose"}]
            -
                name: grasped_ball_drive
                class_name: cognitive_nodes.drive.DriveExponential
                parameters:
                    input_topic: /mdb/baxter/sensor/grasped_ball
                    input_msg: std_msgs.msg.Float32
                    min_eval: 0.8 
                    neighbors: [{"name": "grasped_ball_need", "node_type": "RobotPurpose"}]
            -
                name: novelty_drive
                class_name: cognitive_nodes.novelty.DriveNovelty
                parameters:
                    neighbors: [{"name": "novelty_need", "node_type": "RobotPurpose"}]
            -
                name: effectance_drive
                class_name: cognitive_nodes.effectance.DriveEffectanceInternal
                parameters:
                    ltm_id: ltm_0
                    min_confidence: 0.84
                    limit_depth: False
                    neighbors: [{"name": "effectance_need", "node_type": "RobotPurpose"}]
            -
                name: model_creation_drive
                class_name: cognitive_nodes.model_creation.ModelCreationDrive
                parameters:
                    neighbors: [{"name": "model_creation_need", "node_type": "RobotPurpose"}]
                    LTM_id: ltm_0
                    max_iterations: 20
                    episodes_topic: /main_loop/episodes
                    episodes_msg: cognitive_node_interfaces.msg.Episode
                    model_creation_policy: model_creation_policy

        Goal:
            # -
            #     name: object_in_box_goal
            #     class_name: cognitive_nodes.goal.GoalMotiven
            #     parameters:
            #         neighbors: [{"name": "object_in_box_drive", "node_type": "Drive"}]
            # -
            #     name: grasped_ball_goal
            #     class_name: cognitive_nodes.goal.GoalMotiven
            #     parameters:
            #         neighbors: [{"name": "grasped_ball_drive", "node_type": "Drive"}]
            -
                name: novelty_goal
                class_name: dummy_nodes.dummy_goal.GoalDummy
                parameters:
                    neighbors: [{"name": "novelty_drive", "node_type": "Drive"}]
            -
                name: effectance_goal
                class_name: dummy_nodes.dummy_goal.GoalDummy
                parameters:
                    neighbors: [{"name": "effectance_drive", "node_type": "Drive"}]
            -
                name: model_creation_goal
                class_name: dummy_nodes.dummy_goal.GoalDummy
                parameters:
                    neighbors: [{"name": "model_creation_drive", "node_type": "Drive"}]
        PNode:
            -
                name: novelty_pnode
                class_name: dummy_nodes.dummy_pnodes.ActivatedDummyPNode
                parameters:
                    space_class: cognitive_nodes.space.ActivatedDummySpace
            -
                name: effectance_pnode
                class_name: dummy_nodes.dummy_pnodes.ActivatedDummyPNode
                parameters:
                    space_class: cognitive_nodes.space.ActivatedDummySpace
            -
                name: model_creation_pnode
                class_name: dummy_nodes.dummy_pnodes.ActivatedDummyPNode
                parameters:
                    space_class: cognitive_nodes.space.ActivatedDummySpace
        CNode:
            -
                name: novelty_cnode
                class_name: cognitive_nodes.cnode.CNode
                parameters:
                    neighbors: [{"name": "novelty_goal", "node_type": "Goal"}, {"name": "novelty_pnode", "node_type": "PNode"}]
            -
                name: model_creation_cnode
                class_name: cognitive_nodes.cnode.CNode
                parameters:
                    neighbors: [{"name": "model_creation_goal", "node_type": "Goal"}, {"name": "model_creation_pnode", "node_type": "PNode"}]
            -
                name: effectance_cnode
                class_name: cognitive_nodes.cnode.CNode
                parameters:
                    neighbors: [{"name": "effectance_goal", "node_type": "Goal"}, {"name": "effectance_pnode", "node_type": "PNode"}]
            
            # -
            #     name: object_in_box_cnode
            #     class_name: cognitive_nodes.cnode.CNode
            #     parameters:
            #         neighbors: [{"name": "object_in_box_goal", "node_type": "Goal"}, {"name": "GRIPPER_AND_LOW_FRICTION", "node_type": "WorldModel"}]
            # -
            #     name: grasped_ball_cnode
            #     class_name: cognitive_nodes.cnode.CNode
            #     parameters:
            #         neighbors: [{"name": "grasped_ball_goal", "node_type": "Goal"}, {"name": "GRIPPER_AND_LOW_FRICTION", "node_type": "WorldModel"}]

        Policy:
            -
                name: model_creation_policy
                class_name: cognitive_nodes.model_creation.ModelCreationPolicy
                parameters:
                    neighbors: [{"name": "model_creation_cnode", "node_type": "CNode"}]
                    LTM_id: ltm_0
                    max_iterations: 20
                    episodes_topic: /main_loop/episodes
                    episodes_msg: cognitive_node_interfaces.msg.Episode
            -
                name: effectance_policy
                class_name: cognitive_nodes.effectance.PolicyEffectanceInternal
                parameters:
                    goal_class: cognitive_nodes.effectance.GoalActivatePNode
                    neighbors: [{"name": "effectance_cnode", "node_type": "CNode"}]
                    confidence: 0.5
                    threshold_delta: 0.5
                    limit_depth: False
                    ltm_id: ltm_0            

        UtilityModel:
            -
                name: novelty_exploration
                class_name: cognitive_nodes.utility_model.NoveltyUtilityModel
                new_executor: True
                threads: 2
                parameters:
                    trace_length: 20
                    max_iterations: 50
                    candidate_actions: 100
                    ltm_id: ltm_0
                    neighbors: [{"name": "novelty_cnode", "node_type": "CNode"}]
                    softmax_selection: False
                    softmax_temperature: 0.1

            # -
            #     name: pick_ball
            #     # class_name: cognitive_nodes.utility_model.NoveltyUtilityModel
            #     class_name: cognitive_nodes.utility_model.HardCodedUtilityModel
            #     # class_name: cognitive_nodes.utility_model.LearnedUtilityModel
            #     new_executor: False
            #     threads: 1
            #     parameters:
            #         max_iterations: 20
            #         candidate_actions: 20
            #         ltm_id: ltm_0
            #         neighbors: [{"name": "grasped_ball_cnode", "node_type": "CNode"}]
            #         candidate_generation: "latin"
            #         softmax_selection: True
            #         softmax_temperature: 0.1
            #         min_traces: 10
            #         max_traces: 50
            #         max_antitraces: 10



        

                        

SimulatedBaxter:
    Actuation:
        left_arm:
            dist:
                type: float
                bounds: [0 , 150]
            angle:
                type: float
                bounds: [-120 , 120]
        right_arm:
            dist:
                type: float
                bounds: [0 , 150]
            angle:
                type: float
                bounds: [-120 , 120]
    Perceptions:
        -
            name: ball
            perception_topic: /mdb/baxter/sensor/ball
            perception_msg: simulators_interfaces.msg.Object2DListMsg
        -
            name: ball_in_left_hand
            perception_topic: /mdb/baxter/sensor/ball_in_left_hand
            perception_msg: std_msgs.msg.Bool
        -
            name: ball_in_right_hand
            perception_topic: /mdb/baxter/sensor/ball_in_right_hand
            perception_msg: std_msgs.msg.Bool
        -
            name: box
            perception_topic: /mdb/baxter/sensor/box
            perception_msg: simulators_interfaces.msg.Object2DListMsg
        -
            name: left_arm
            perception_topic: /mdb/baxter/sensor/left_arm
            perception_msg: simulators_interfaces.msg.Object2DListMsg
        -
            name: right_arm
            perception_topic: /mdb/baxter/sensor/right_arm
            perception_msg: simulators_interfaces.msg.Object2DListMsg
        -
            name: ball_in_box
            perception_topic: /mdb/baxter/sensor/ball_in_box
            perception_msg: std_msgs.msg.Float32
        -
            name: grasped_ball
            perception_topic: /mdb/baxter/sensor/grasped_ball
            perception_msg: std_msgs.msg.Float32
        -
            name: dist_left_arm_ball
            perception_topic: /mdb/baxter/sensor/dist_left_arm_ball
            perception_msg: simulators_interfaces.msg.ObjectListMsg
        -
            name: dist_right_arm_ball
            perception_topic: /mdb/baxter/sensor/dist_right_arm_ball
            perception_msg: simulators_interfaces.msg.ObjectListMsg
        -
            name: dist_ball_box
            perception_topic: /mdb/baxter/sensor/dist_ball_box
            perception_msg: simulators_interfaces.msg.ObjectListMsg
        -
            name: box_angle
            perception_topic: /mdb/baxter/sensor/box_angle
            perception_msg: std_msgs.msg.Float32
        -
            name: ball_angle
            perception_topic: /mdb/baxter/sensor/ball_angle
            perception_msg: std_msgs.msg.Float32